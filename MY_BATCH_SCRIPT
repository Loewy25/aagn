#!/bin/bash


#SBATCH --job-name=test #Assign a descriptive job name

#SBATCH -N 1                    # Request 1 node
#SBATCH --mem=100G               # Request 400GB memory
#SBATCH -t 19:30:00             # Set maximum time


#SBATCH --gres=gpu:nvidia_a100_80:1
#SBATCH --partition=tier2_gpu
#SBATCH --account=aristeidis_sotiras
#SBATCH --exclude=gpu02


##SBATCH --array=0-7              # Array of 8 tasks (0 to 7)

# Output and error filenames based on job ID and task ID
#SBATCH --output=slurm-%A_%a.out
#SBATCH --error=slurm-%A_%a.err

# Activate Conda
source /home/l.peiwang/miniconda3/etc/profile.d/conda.sh
conda activate miccai2

module load cuda/11.3
module load cudnn/9.6.0.74-cuda11

pip install --upgrade pip
pip install torch==1.12.1+cu113 torchvision==0.13.1+cu113 torchaudio==0.12.1 \
  --index-url https://download.pytorch.org/whl/cu113
python -c "import torch; print(torch.__version__, torch.cuda.is_available(), torch.version.cuda)"
# Expected: 1.12.1 True 11.3



python train.py

